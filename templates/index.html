<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>療癒食光諮詢助手</title>
</head>
<body>
    <h2>療癒食光諮詢助手</h2>
    <label for="gender">性別：</label>
    <select id="gender">
        <option value="男性">男性</option>
        <option value="女性">女性</option>
    </select><br>

    <label for="age">年齡：</label>
    <input type="number" id="age" min="10" max="120"><br>

    <label for="height">身高(cm)：</label>
    <input type="number" id="height" min="100" max="250"><br>

    <label for="weight">體重(kg)：</label>
    <input type="number" id="weight" min="30" max="200"><br>

    <label for="goal">目標：</label>
    <select id="goal">
        <option value="減脂">減脂</option>
        <option value="減重">減重</option>
        <option value="減脂增肌">減脂增肌</option>
    </select><br>

    <button onclick="submit()">送出</button>
    <div id="loading" style="display:none;">🔄 諮詢中...</div>
    <div id="result"></div>

    <script>
    async function submit() {
        document.getElementById("loading").style.display = "block";
        document.getElementById("result").innerHTML = "";

        const data = {
            gender: document.getElementById("gender").value,
            age: document.getElementById("age").value,
            height: document.getElementById("height").value,
            weight: document.getElementById("weight").value,
            goal: document.getElementById("goal").value
        };

        const response = await fetch("/chat", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        document.getElementById("loading").style.display = "none";
        if (result.reply) {
            document.getElementById("result").innerHTML = result.reply.map(r =>
                `<h3>${r.title}</h3><pre>${r.content}</pre>`
            ).join("");
        } else {
            document.getElementById("result").innerText = result.error || "發生錯誤";
        }
    }
    </script>
</body>
</html>