<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ç™‚ç™’é£Ÿå…‰è«®è©¢åŠ©æ‰‹ï¼ˆåˆ†æ®µç‰ˆï¼‰</title>
  <style>
    label { display: inline-block; width: 80px; }
    select, input { margin-bottom: 8px; }
    #result { margin-top: 20px; white-space: pre-line; }
  </style>
</head>
<body>
  <h2>ç™‚ç™’é£Ÿå…‰è«®è©¢åŠ©æ‰‹ï¼ˆåˆ†æ®µç‰ˆï¼‰</h2>
  <div>
    <label>æ€§åˆ¥ï¼š</label>
    <select id="gender">
      <option value="ç”·æ€§">ç”·æ€§</option>
      <option value="å¥³æ€§">å¥³æ€§</option>
    </select><br>
    <label>å¹´é½¡ï¼š</label>
    <input type="number" id="age" value="30"><br>
    <label>èº«é«˜(cm)ï¼š</label>
    <input type="number" id="height" value="175"><br>
    <label>é«”é‡(kg)ï¼š</label>
    <input type="number" id="weight" value="70"><br>
    <label>ç›®æ¨™ï¼š</label>
    <select id="goal">
      <option value="æ¸›è„‚">æ¸›è„‚</option>
      <option value="æ¸›é‡">æ¸›é‡</option>
      <option value="æ¸›è„‚å¢è‚Œ">æ¸›è„‚å¢è‚Œ</option>
    </select><br>
    <button onclick="submitData()">é€å‡º</button>
  </div>
  <div id="loading" style="color: gray; display:none;">è«®è©¢ä¸­...</div>
  <div id="result"></div>
  <script>
    async function submitData() {
      const gender = document.getElementById('gender').value;
      const age = document.getElementById('age').value;
      const height = document.getElementById('height').value;
      const weight = document.getElementById('weight').value;
      const goal = document.getElementById('goal').value;
      const user_input = `æ€§åˆ¥ï¼š${gender}ï¼Œå¹´é½¡ï¼š${age}ï¼Œèº«é«˜ï¼š${height}cmï¼Œé«”é‡ï¼š${weight}kgï¼Œç›®æ¨™ï¼š${goal}`;
      const sections = [
        "ğŸ“Œ åŸºæœ¬è³‡æ–™æ‘˜è¦",
        "ğŸ½ æ¯æ—¥ä¸‰é¤å»ºè­°",
        "ğŸŒ è¨“ç·´å‰å¾Œé£²é£Ÿå»ºè­°",
        "ğŸƒâ€â™‚ï¸ ä¸€é€±é‹å‹•å»ºè­°"
      ];
      const resultDiv = document.getElementById("result");
      const loadingDiv = document.getElementById("loading");
      resultDiv.innerHTML = "";
      loadingDiv.style.display = "block";

      for (let section of sections) {
        resultDiv.innerHTML += `<h3>${section}</h3><p>è«‹ç¨å€™...</p>`;
        const res = await fetch("/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ user_input, section })
        });
        const data = await res.json();
        const blocks = resultDiv.querySelectorAll("h3");
        blocks.forEach((block) => {
          if (block.textContent === section) {
            block.insertAdjacentHTML("afterend", `<pre>${data.content}</pre>`);
          }
        });
      }

      loadingDiv.style.display = "none";
    }
  </script>
</body>
</html>